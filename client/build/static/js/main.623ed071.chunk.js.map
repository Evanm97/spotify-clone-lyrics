{"version":3,"sources":["Login.js","TrackSearchResult.js","Player.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","minWidth","href","bgColor","color","target","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","title","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","styles","activeColor","altColor","loaderColor","sliderColor","sliderHandleColor","trackArtistColor","trackNameColor","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","backgroundColor","id","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.623ed071.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Container } from \"react-bootstrap\";\r\nimport GitHubCorners from \"@uiw/react-github-corners\";\r\n\r\nconst AUTH_URL =\r\n  \"https://accounts.spotify.com/authorize?client_id=bf628795576b4bad9b71cde40e4aae48&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\";\r\n\r\nexport default function Login() {\r\n  return (\r\n    <Container\r\n      className=\"d-flex justify-content-center align-items-center\"\r\n      style={{ minHeight: \"100vh\", minWidth: \"100vw\" }}\r\n    >\r\n      <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\r\n        Login With Spotify\r\n      </a>\r\n\r\n      <GitHubCorners\r\n        bgColor=\"#1cb954\"\r\n        color=\"#000000\"\r\n        href=\"https://github.com/Evanm97/spotify-clone-lyrics\"\r\n        target=\"_blank\"\r\n      />\r\n    </Container>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nexport default function TrackSearchResult({ track, chooseTrack }) {\r\n  function handlePlay() {\r\n    chooseTrack(track);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"d-flex m-2 align-items-center\"\r\n      style={{ cursor: \"pointer\" }}\r\n      onClick={handlePlay}\r\n    >\r\n      <img src={track.albumUrl} style={{ height: \"64px\", width: \"64px\" }} />\r\n      <div className=\"ml-3\">\r\n        <div>{track.title}</div>\r\n        <div className=\"text-muted\">{track.artist}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport SpotifyPlayer from \"react-spotify-web-playback\";\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n  const [play, setPlay] = useState(false);\r\n\r\n  useEffect(() => setPlay(true), [trackUri]);\r\n\r\n  if (!accessToken) return null;\r\n  return (\r\n    <SpotifyPlayer\r\n      token={accessToken}\r\n      showSaveIcon\r\n      callback={(state) => {\r\n        if (!state.isPlaying) setPlay(false);\r\n      }}\r\n      play={play}\r\n      uris={trackUri ? [trackUri] : []}\r\n      styles={{\r\n        activeColor: \"#fff\",\r\n        bgColor: \"#333\",\r\n        altColor: \"#1cb954\",\r\n        color: \"#fff\",\r\n        loaderColor: \"#fff\",\r\n        sliderColor: \"#1cb954\",\r\n        sliderHandleColor: \"#1cb954\",\r\n        trackArtistColor: \"#ccc\",\r\n        trackNameColor: \"#fff\",\r\n        height: \"70px\",\r\n      }}\r\n    />\r\n  );\r\n}","import { useState, useEffect } from \"react\";\r\nimport { Container, Form } from \"react-bootstrap\";\r\nimport useAuth from \"./useAuth\";\r\nimport SpotifyWebApi from \"spotify-web-api-node\";\r\nimport TrackSearchResult from \"./TrackSearchResult\";\r\nimport Player from \"./Player\";\r\nimport axios from \"axios\";\r\nimport GitHubCorners from \"@uiw/react-github-corners\";\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n  clientId: \"bf628795576b4bad9b71cde40e4aae48\",\r\n});\r\n\r\nexport default function Dashboard({ code }) {\r\n  const accessToken = useAuth(code);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [playingTrack, setPlayingTrack] = useState();\r\n  const [lyrics, setLyrics] = useState(\"\");\r\n\r\n  function chooseTrack(track) {\r\n    setPlayingTrack(track);\r\n    setSearch(\"\");\r\n    setLyrics(\"\");\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!playingTrack) return;\r\n\r\n    axios\r\n      .get(\"http://localhost:3001/lyrics\", {\r\n        params: {\r\n          track: playingTrack.title,\r\n          artist: playingTrack.artist,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        setLyrics(res.data.lyrics);\r\n      });\r\n  }, [playingTrack]);\r\n\r\n  useEffect(() => {\r\n    if (!accessToken) return;\r\n    spotifyApi.setAccessToken(accessToken);\r\n  }, [accessToken]);\r\n\r\n  useEffect(() => {\r\n    if (!search) return setSearchResults([]);\r\n    if (!accessToken) return;\r\n\r\n    let cancel = false;\r\n    spotifyApi.searchTracks(search).then((res) => {\r\n      if (cancel) return;\r\n      setSearchResults(\r\n        res.body.tracks.items.map((track) => {\r\n          const smallestAlbumImage = track.album.images.reduce(\r\n            (smallest, image) => {\r\n              if (image.height < smallest.height) return image;\r\n              return smallest;\r\n            },\r\n            track.album.images[0]\r\n          );\r\n\r\n          return {\r\n            artist: track.artists[0].name,\r\n            title: track.name,\r\n            uri: track.uri,\r\n            albumUrl: smallestAlbumImage.url,\r\n          };\r\n        })\r\n      );\r\n    });\r\n\r\n    return () => (cancel = true);\r\n  }, [search, accessToken]);\r\n\r\n  return (\r\n    <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\" }}>\r\n      <GitHubCorners\r\n        bgColor=\"#1cb954\"\r\n        color=\"#000000\"\r\n        href=\"https://github.com/Evanm97/spotify-clone-lyrics\"\r\n        target=\"_blank\"\r\n      />\r\n      <Form.Control\r\n        className=\"search\"\r\n        type=\"search\"\r\n        placeholder=\"Search\"\r\n        value={search}\r\n        onChange={(e) => setSearch(e.target.value)}\r\n        style={{ backgroundColor: \"#333\", color: \"white\" }}\r\n      />\r\n      <div\r\n        id=\"search-results\"\r\n        className=\"flex-grow-1 my-2\"\r\n        style={{ overflowY: \"auto\", backgroundColor: \"#000000\" }}\r\n      >\r\n        {searchResults.map((track) => (\r\n          <TrackSearchResult\r\n            track={track}\r\n            key={track.uri}\r\n            chooseTrack={chooseTrack}\r\n          />\r\n        ))}\r\n        {searchResults.length === 0 && (\r\n          <div className=\"text-center\" style={{ whiteSpace: \"pre\" }}>\r\n            {lyrics}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <Player accessToken={accessToken} trackUri={playingTrack?.uri} />\r\n      </div>\r\n    </Container>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState();\r\n  const [refreshToken, setRefreshToken] = useState();\r\n  const [expiresIn, setExpiresIn] = useState();\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .post(\"/login\", {\r\n        code,\r\n      })\r\n      .then((res) => {\r\n        setAccessToken(res.data.accessToken);\r\n        setRefreshToken(res.data.refreshToken);\r\n        setExpiresIn(res.data.expiresIn);\r\n        window.history.pushState({}, null, \"/\");\r\n      })\r\n      .catch(() => {\r\n        window.location = \"/\";\r\n      });\r\n  }, [code]);\r\n\r\n  useEffect(() => {\r\n    if (!refreshToken || !expiresIn) return;\r\n    const interval = setInterval(() => {\r\n      axios\r\n        .post(\"/refresh\", {\r\n          refreshToken,\r\n        })\r\n        .then((res) => {\r\n          setAccessToken(res.data.accessToken);\r\n          setExpiresIn(res.data.expiresIn);\r\n        })\r\n        .catch(() => {\r\n          window.location = \"/\";\r\n        });\r\n    }, (expiresIn - 60) * 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [refreshToken, expiresIn]);\r\n\r\n  return accessToken;\r\n}\r\n","import './App.css';\nimport \"bootstrap/dist/css/bootstrap.min.css\"\nimport Login from './Login'\nimport Dashboard from './Dashboard'\n\nconst code = new URLSearchParams(window.location.search).get('code')\n\nfunction App() {\n  return code ? <Dashboard code={code} /> : <Login />\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}